"use strict";(self.webpackChunktraining_app=self.webpackChunktraining_app||[]).push([[596],{6596:(L,_,o)=>{o.r(_),o.d(_,{amplify_s3_album:()=>E});var y,v=o(8239),l=o(4600),b=o(1735),x=o(3531),T=o(6845),I=o(5640),O=o(6289),A=o(4102),f=o(8094),p=o(4797),P=new Uint8Array(16);function k(){if(!y&&!(y="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return y(P)}const C=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function D(t){return"string"==typeof t&&C.test(t)}for(var r=[],u=0;u<256;++u)r.push((u+256).toString(16).substr(1));function w(t,e,i){var s=(t=t||{}).random||(t.rng||k)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e){i=i||0;for(var n=0;n<16;++n)e[i+n]=s[n];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(r[t[e+0]]+r[t[e+1]]+r[t[e+2]]+r[t[e+3]]+"-"+r[t[e+4]]+r[t[e+5]]+"-"+r[t[e+6]]+r[t[e+7]]+"-"+r[t[e+8]]+r[t[e+9]]+"-"+r[t[e+10]]+r[t[e+11]]+r[t[e+12]]+r[t[e+13]]+r[t[e+14]]+r[t[e+15]]).toLowerCase();if(!D(i))throw TypeError("Stringified UUID is invalid");return i}(s)}const d=new b.k("S3Album"),E=class{constructor(t){var e=this;(0,l.r)(this,t),this.contentType="binary/octet-stream",this.level=I.A.Public,this.picker=!0,this.pickerText=O.T.PICKER_TEXT,this.albumItems=[],this.imgArr={},this.list=(0,v.Z)(function*(){const{path:i="",level:s,track:n,identityId:a}=e;if(d.debug("Album path: "+i),!f.Ke||"function"!=typeof f.Ke.list)throw new Error(A.d);try{const m=yield f.Ke.list(i,{level:s,track:n,identityId:a});e.marshal(m)}catch(m){d.warn(m)}}),this.marshal=i=>{i.forEach(a=>{const g=a.key.toLowerCase().split(".")[1];p.i.has(g)&&(!a.contentType||a.contentType&&"binary/octet-stream"===a.contentType)&&(a.contentType=this.getContentType(a))});const s=i.filter(a=>a.contentType&&a.contentType.startsWith("image/"));let n=this.filter?this.filter(s):s;n=this.sort?this.sort(n):n,this.albumItems=n,d.debug("album items",this.albumItems),this.constructImgArray(this.albumItems)},this.constructImgArray=i=>{i.map(s=>{this.imgArr[`${s.key}`]=s.key})},this.handlePick=function(){var i=(0,v.Z)(function*(s){const n=s.target.files[0],{path:a="",level:m,track:g,fileToKey:K}=e,c=a+(0,p.c)(n,K);try{yield(0,p.p)(c,n,m,g,n.type,d)}catch(h){throw d.error(h),new Error(h)}if(Object.keys(e.imgArr).includes(c))e.albumItems=[...e.albumItems],e.imgArr[c]=`${c}-${w()}`;else{const h=[...e.albumItems,...e.filter?e.filter([{key:c}]):[{key:c}]];e.albumItems=e.sort?e.sort(h):h}});return function(s){return i.apply(this,arguments)}}()}getContentType(t){return(0,x.rI)(t.key,"image/*")}componentWillLoad(){this.list()}render(){return(0,l.h)("div",null,(0,l.h)("div",{class:"album-container"},(0,l.h)("div",{class:"grid-row"},this.albumItems.map(t=>(0,l.h)("div",{class:"grid-item",key:`key-${t.key}`},(0,l.h)("amplify-s3-image",{key:this.imgArr[t.key],imgKey:t.key,level:this.level,path:this.path,identityId:this.identityId,track:this.track,handleOnError:this.handleOnError,handleOnLoad:this.handleOnLoad}),(0,l.h)("span",{class:"img-overlay"}))))),this.picker&&(0,l.h)("amplify-picker",{pickerText:T.o.get(this.pickerText),inputHandler:t=>this.handlePick(t),acceptValue:"image/*"}))}};E.style=":host{--overlay-bg-color:rgba(0, 0, 0, 0.15)}.album-container{-webkit-box-sizing:border-box;box-sizing:border-box;max-width:100%;margin:0 auto;padding:0 2rem}.grid-row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:-1rem -1rem;padding-bottom:3rem}.grid-item{position:relative;-ms-flex:1 0 22rem;flex:1 0 22rem;-ms-flex-positive:1;flex-grow:1;margin:1rem;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}amplify-s3-image{--width:22rem;--height:20rem;border-radius:5px;-o-object-fit:cover;object-fit:cover}.img-overlay{display:none;width:100%;height:21rem;position:absolute;top:0;left:0;background-color:var(--overlay-bg-color)}.grid-item:hover .img-overlay{display:block}"}}]);