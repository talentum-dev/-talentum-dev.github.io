"use strict";(self.webpackChunktraining_app=self.webpackChunktraining_app||[]).push([[249],{3249:(U,F,p)=>{p.r(F),p.d(F,{amplify_confirm_sign_in:()=>T,amplify_confirm_sign_up:()=>w,amplify_forgot_password:()=>S,amplify_require_new_password:()=>E,amplify_sign_in:()=>y,amplify_sign_up:()=>A,amplify_verify_contact:()=>v});var m=p(8239),s=p(4600),r=p(6845),b=p(1735),I=p(3531),l=p(4052),u=p(4932),i=p(6289),h=p(4102),o=p(9571),f=p(6036);const T=class{constructor(t){(0,s.r)(this,t),this.handleSubmit=e=>this.confirm(e),this.headerText=i.T.CONFIRM_SMS_CODE,this.submitButtonText=i.T.CONFIRM,this.handleAuthStateChange=o.d,this.defaultFormFields=[{type:"code",required:!0,handleInputChange:e=>this.handleCodeChange(e)}],this.formFields=this.defaultFormFields,this.mfaOption=l.M.SMS,this.loading=!1}componentWillLoad(){this.setup()}userHandler(){this.setup()}setup(){this.user&&this.user.challengeName===l.C.SoftwareTokenMFA&&(this.mfaOption=l.M.TOTP,this.headerText===i.T.CONFIRM_SMS_CODE&&(this.headerText=i.T.CONFIRM_TOTP_CODE)),this.constructedFormFieldOptions=this.constructFormFieldOptions(this.formFields)}handleCodeChange(t){this.code=t.target.value}confirm(t){var e=this;return(0,m.Z)(function*(){t&&t.preventDefault();const n=e.user.challengeName===l.C.SoftwareTokenMFA?l.C.SoftwareTokenMFA:null;if(!u.g||"function"!=typeof u.g.confirmSignIn)throw new Error(h.N);e.loading=!0;try{yield u.g.confirmSignIn(e.user,e.code,n),yield(0,f.c)(e.user,e.handleAuthStateChange)}catch(a){(0,o.a)(a)}finally{e.loading=!1}})()}constructFormFieldOptions(t){const e=[];if(void 0!==t)return t.length<=0?this.defaultFormFields:(t.forEach(n=>{e.push("string"==typeof n||"code"!==n.type?n:Object.assign({handleInputChange:a=>this.handleCodeChange(a)},n))}),e)}render(){return(0,s.h)(s.H,null,(0,s.h)("amplify-form-section",{headerText:r.o.get(this.headerText),handleSubmit:this.handleSubmit,submitButtonText:r.o.get(this.submitButtonText),loading:this.loading,secondaryFooterContent:(0,s.h)("span",null,(0,s.h)("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.A.SignIn)},r.o.get(i.T.BACK_TO_SIGN_IN)))},(0,s.h)("amplify-auth-fields",{formFields:this.constructedFormFieldOptions})))}static get watchers(){return{user:["userHandler"]}}},w=class{constructor(t){(0,s.r)(this,t),this.handleSubmit=e=>this.confirmSignUp(e),this.headerText=i.T.CONFIRM_SIGN_UP_HEADER_TEXT,this.submitButtonText=i.T.CONFIRM_SIGN_UP_SUBMIT_BUTTON_TEXT,this.formFields=[],this.handleAuthStateChange=o.d,this.usernameAlias="username",this.loading=!1,this.newFormFields=[],this.phoneNumber={countryDialCodeValue:h.g,phoneNumberValue:null}}componentWillLoad(){this.setup()}formFieldsHandler(){this.buildFormFields()}userHandler(){this.setup()}setup(){this.userInput=this.user&&this.user.username,this._signUpAttrs=this.user&&this.user.signUpAttrs,(0,o.c)(this.usernameAlias),this.buildFormFields()}buildDefaultFormFields(){this.newFormFields=[{type:`${this.usernameAlias}`,required:!0,handleInputChange:this.handleFormFieldInputChange(`${this.usernameAlias}`),value:this.userInput,disabled:!!this.userInput,inputProps:{autocomplete:"username"}},{type:"code",label:r.o.get(i.T.CONFIRM_SIGN_UP_CODE_LABEL),placeholder:r.o.get(i.T.CONFIRM_SIGN_UP_CODE_PLACEHOLDER),required:!0,hint:(0,s.h)("div",null,r.o.get(i.T.CONFIRM_SIGN_UP_LOST_CODE)," ",(0,s.h)("amplify-button",{variant:"anchor",onClick:()=>this.resendConfirmCode()},r.o.get(i.T.CONFIRM_SIGN_UP_RESEND_CODE))),handleInputChange:this.handleFormFieldInputChange("code")}]}buildFormFields(){if(0===this.formFields.length)this.buildDefaultFormFields();else{const t=[];this.formFields.forEach(e=>{const n=Object.assign({},e);"code"===n.type&&(n.hint=(0,o.i)(n)?(0,s.h)("div",null,r.o.get(i.T.CONFIRM_SIGN_UP_LOST_CODE)," ",(0,s.h)("amplify-button",{variant:"anchor",onClick:()=>this.resendConfirmCode()},r.o.get(i.T.CONFIRM_SIGN_UP_RESEND_CODE))):n.hint),n.handleInputChange=a=>this.handleFormFieldInputWithCallback(a,e),t.push(n)}),this.newFormFields=t}}handleFormFieldInputChange(t){switch(t){case"username":case"email":return e=>this.userInput=e.target.value;case"phone_number":return e=>(0,o.h)(e,this.phoneNumber);case"code":return e=>this.code=e.target.value;default:return}}setFieldValue(t){switch(t.type){case"username":case"email":this.userInput=void 0===t.value?"":t.value;break;case"phone_number":t.dialCode&&(this.phoneNumber.countryDialCodeValue=t.dialCode),this.phoneNumber.phoneNumberValue=t.value}}handleFormFieldInputWithCallback(t,e){(e.handleInputChange?e.handleInputChange:(d,g)=>{g(d)})(t,this.handleFormFieldInputChange(e.type).bind(this))}getUsername(){if(this.user&&this.user.username)return this.user.username;switch(this.usernameAlias){case"username":case"email":return this.userInput;case"phone_number":return(0,o.b)(this.phoneNumber)}}resendConfirmCode(){var t=this;return(0,m.Z)(function*(){if(event&&event.preventDefault(),!u.g||"function"!=typeof u.g.resendSignUp)throw new Error(h.N);try{const e=t.getUsername();if(!e)throw new Error(i.T.EMPTY_USERNAME);yield u.g.resendSignUp(e.trim())}catch(e){(0,o.a)(e)}})()}confirmSignUp(t){var e=this;return(0,m.Z)(function*(){if(t&&t.preventDefault(),!u.g||"function"!=typeof u.g.confirmSignUp)throw new Error(h.N);e.loading=!0;try{let n=e.getUsername();if(!n)throw new Error(i.T.EMPTY_USERNAME);if(n=n.trim(),!(yield u.g.confirmSignUp(n,e.code)))throw new Error(r.o.get(i.T.CONFIRM_SIGN_UP_FAILED));e._signUpAttrs&&e._signUpAttrs.password&&""!==e._signUpAttrs.password?yield(0,f.h)(n,e._signUpAttrs.password,e.handleAuthStateChange):e.handleAuthStateChange(l.A.SignIn)}catch(n){(0,o.a)(n)}finally{e.loading=!1}})()}render(){return(0,s.h)(s.H,null,(0,s.h)("amplify-form-section",{headerText:r.o.get(this.headerText),submitButtonText:r.o.get(this.submitButtonText),handleSubmit:this.handleSubmit,loading:this.loading,secondaryFooterContent:(0,s.h)("div",null,(0,s.h)("span",null,(0,s.h)("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.A.SignIn)},r.o.get(i.T.BACK_TO_SIGN_IN))))},(0,s.h)("amplify-auth-fields",{formFields:this.newFormFields})))}static get watchers(){return{formFields:["formFieldsHandler"],user:["userHandler"]}}},C=new b.k("ForgotPassword"),S=class{constructor(t){(0,s.r)(this,t),this.headerText=i.T.RESET_YOUR_PASSWORD,this.sendButtonText=i.T.SEND_CODE,this.submitButtonText=i.T.SUBMIT,this.formFields=[],this.handleSend=e=>this.send(e),this.handleSubmit=e=>this.submit(e),this.handleAuthStateChange=o.d,this.usernameAlias="username",this.delivery=null,this.loading=!1,this.phoneNumber={countryDialCodeValue:h.g,phoneNumberValue:null},this.newFormFields=[],this.forgotPasswordAttrs={userInput:"",password:"",code:""}}componentWillLoad(){(0,o.c)(this.usernameAlias),this.buildFormFields()}formFieldsHandler(){this.buildFormFields()}buildFormFields(){if(0===this.formFields.length)this.buildDefaultFormFields();else{const t=[];this.formFields.forEach(e=>{const n=Object.assign({},e);n.handleInputChange=a=>this.handleFormFieldInputWithCallback(a,e),t.push(n)}),this.newFormFields=t}}buildDefaultFormFields(){switch(this.usernameAlias){case"email":this.newFormFields=[{type:"email",required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"forgot-password-email-input"}}];break;case"phone_number":this.newFormFields=[{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"forgot-password-phone-number-input"}}];break;case"username":default:this.newFormFields=[{type:"username",required:!0,handleInputChange:this.handleFormFieldInputChange("username"),inputProps:{"data-test":"forgot-password-username-input"}}]}}handleFormFieldInputChange(t){switch(t){case"username":case"email":return e=>this.forgotPasswordAttrs.userInput=e.target.value;case"phone_number":return e=>(0,o.h)(e,this.phoneNumber);case"password":case"code":return e=>this.forgotPasswordAttrs[t]=e.target.value;default:return}}setFieldValue(t,e){switch(t.type){case"username":case"email":e.userInput=void 0===t.value?"":t.value;break;case"phone_number":t.dialCode&&(this.phoneNumber.countryDialCodeValue=t.dialCode),this.phoneNumber.phoneNumberValue=t.value;break;case"password":case"code":e[t.type]=void 0===t.value?"":t.value}}handleFormFieldInputWithCallback(t,e){(e.handleInputChange?e.handleInputChange:(d,g)=>{g(d)})(t,this.handleFormFieldInputChange(e.type).bind(this))}send(t){var e=this;return(0,m.Z)(function*(){if(t&&t.preventDefault(),!u.g||"function"!=typeof u.g.forgotPassword)throw new Error(h.N);switch(e.loading=!0,e.usernameAlias){case"phone_number":try{e.forgotPasswordAttrs.userInput=(0,o.b)(e.phoneNumber)}catch(n){(0,o.a)(n)}}try{const n=yield u.g.forgotPassword(e.forgotPasswordAttrs.userInput.trim());C.debug(n),e.newFormFields=[{type:"code",required:!0,handleInputChange:e.handleFormFieldInputChange("code"),inputProps:{"data-test":"forgot-password-code-input"}},{type:"password",required:!0,handleInputChange:e.handleFormFieldInputChange("password"),label:r.o.get(i.T.NEW_PASSWORD_LABEL),placeholder:r.o.get(i.T.NEW_PASSWORD_PLACEHOLDER)}],e.delivery=n.CodeDeliveryDetails}catch(n){(0,o.a)(n)}finally{e.loading=!1}})()}submit(t){var e=this;return(0,m.Z)(function*(){if(t&&t.preventDefault(),!u.g||"function"!=typeof u.g.forgotPasswordSubmit)throw new Error(h.N);e.loading=!0;try{const{userInput:n,code:a,password:d}=e.forgotPasswordAttrs,g=yield u.g.forgotPasswordSubmit(n.trim(),a,d);C.debug(g),e.handleAuthStateChange(l.A.SignIn),e.delivery=null}catch(n){(0,o.a)(n)}finally{e.loading=!1}})()}render(){const t=this.delivery?n=>this.handleSubmit(n):n=>this.handleSend(n),e=this.delivery?this.submitButtonText:this.sendButtonText;return(0,s.h)(s.H,null,(0,s.h)("amplify-form-section",{headerText:r.o.get(this.headerText),handleSubmit:t,loading:this.loading,secondaryFooterContent:(0,s.h)("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.A.SignIn),"data-test":"forgot-password-back-to-sign-in-link"},r.o.get(i.T.BACK_TO_SIGN_IN)),testDataPrefix:"forgot-password",submitButtonText:r.o.get(e)},(0,s.h)("amplify-auth-fields",{formFields:this.newFormFields})))}static get watchers(){return{formFields:["formFieldsHandler"]}}},_=new b.k("amplify-require-new-password"),E=class{constructor(t){(0,s.r)(this,t),this.headerText=i.T.CHANGE_PASSWORD,this.submitButtonText=i.T.CHANGE_PASSWORD_ACTION,this.handleSubmit=e=>this.completeNewPassword(e),this.handleAuthStateChange=o.d,this.formFields=[{type:l.a.Password,required:!0,handleInputChange:e=>this.handlePasswordChange(e),label:r.o.get(i.T.NEW_PASSWORD_LABEL),placeholder:r.o.get(i.T.NEW_PASSWORD_PLACEHOLDER),inputProps:{"data-test":"require-new-password-password-input"}}],this.loading=!1,this.requiredAttributes={},this.newFormFields=this.formFields,this.phoneNumber={countryDialCodeValue:h.g,phoneNumberValue:" "}}userHandler(){this.setCurrentUser()}handleRequiredAttributeInputChange(t,e){"phone_number"===t?this.formatPhoneNumber(e):this.requiredAttributes[t]=e.target.value}setCurrentUser(){var t=this;return(0,m.Z)(function*(){if(t.user)t.currentUser=t.user;else try{const e=yield u.g.currentAuthenticatedUser();e&&(t.currentUser=e)}catch(e){(0,o.a)(e)}if(t.currentUser&&t.currentUser.challengeParam&&t.currentUser.challengeParam.requiredAttributes){const e=t.currentUser.challengeParam.requiredAttributes,n=(0,o.g)();e.forEach(a=>{const d={type:a,required:!0,label:n[a].label,placeholder:n[a].placeholder,handleInputChange:g=>t.handleRequiredAttributeInputChange(a,g),inputProps:{"data-test":`require-new-password-${a}-input`}};t.newFormFields=[...t.newFormFields,d]})}})()}componentWillLoad(){return this.setCurrentUser()}handlePasswordChange(t){this.password=t.target.value}formatPhoneNumber(t){(0,o.h)(t,this.phoneNumber);try{if(t.target.name===h.b&&this.phoneNumber.phoneNumberValue){const e=(0,o.b)(this.phoneNumber);this.requiredAttributes.phone_number=e}}catch(e){_.error(`error in phone number field - ${e}`)}}completeNewPassword(t){var e=this;return(0,m.Z)(function*(){if(t&&t.preventDefault(),!u.g||"function"!=typeof u.g.completeNewPassword)throw new Error(h.N);e.loading=!0;try{const n=yield u.g.completeNewPassword(e.currentUser,e.password,e.requiredAttributes);switch(_.debug("complete new password",n),n.challengeName){case l.C.SMSMFA:e.handleAuthStateChange(l.A.ConfirmSignIn,n);break;case l.C.MFASetup:_.debug("TOTP setup",n.challengeParam),e.handleAuthStateChange(l.A.TOTPSetup,n);break;default:yield(0,f.c)(n,e.handleAuthStateChange)}}catch(n){(0,o.a)(n)}finally{e.loading=!1}})()}render(){return(0,s.h)(s.H,null,(0,s.h)("amplify-form-section",{headerText:r.o.get(this.headerText),handleSubmit:this.handleSubmit,loading:this.loading,secondaryFooterContent:(0,s.h)("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.A.SignIn)},r.o.get(i.T.BACK_TO_SIGN_IN)),submitButtonText:r.o.get(this.submitButtonText)},(0,s.h)("amplify-auth-fields",{formFields:this.newFormFields})))}static get watchers(){return{user:["userHandler"]}}},y=class{constructor(t){(0,s.r)(this,t),this.handleSubmit=e=>this.signIn(e),this.headerText=i.T.SIGN_IN_HEADER_TEXT,this.submitButtonText=i.T.SIGN_IN_ACTION,this.handleAuthStateChange=o.d,this.usernameAlias="username",this.formFields=[],this.hideSignUp=!1,this.newFormFields=[],this.loading=!1,this.phoneNumber={countryDialCodeValue:h.g,phoneNumberValue:null},this.signInAttributes={userInput:"",password:""}}componentWillLoad(){(0,o.c)(this.usernameAlias),this.buildFormFields()}formFieldsHandler(){this.buildFormFields()}handleFormFieldInputChange(t){switch(t){case"username":case"email":return e=>this.signInAttributes.userInput=e.target.value;case"phone_number":return e=>(0,o.h)(e,this.phoneNumber);case"password":return e=>this.signInAttributes.password=e.target.value;default:return()=>{}}}handleFormFieldInputWithCallback(t,e){(e.handleInputChange?e.handleInputChange:(d,g)=>{g(d)})(t,this.handleFormFieldInputChange(e.type).bind(this))}signIn(t){var e=this;return(0,m.Z)(function*(){switch(t&&t.preventDefault(),e.loading=!0,e.usernameAlias){case"phone_number":try{e.signInAttributes.userInput=(0,o.b)(e.phoneNumber)}catch(a){(0,o.a)(a)}}const n=e.signInAttributes.userInput.trim();yield(0,f.h)(n,e.signInAttributes.password,e.handleAuthStateChange,e.usernameAlias),e.loading=!1})()}buildDefaultFormFields(){const t=[];switch(this.usernameAlias){case"email":t.push({type:"email",required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-in-email-input",autocomplete:"username"}});break;case"phone_number":t.push({type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-in-phone-number-input",autocomplete:"username"}});break;case"username":default:t.push({type:"username",required:!0,handleInputChange:this.handleFormFieldInputChange("username"),inputProps:{"data-test":"sign-in-username-input",autocomplete:"username"}})}t.push({type:"password",hint:(0,s.h)("div",null,r.o.get(i.T.FORGOT_PASSWORD_TEXT)," ",(0,s.h)("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.A.ForgotPassword),"data-test":"sign-in-forgot-password-link"},r.o.get(i.T.RESET_PASSWORD_TEXT))),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-in-password-input"}}),this.newFormFields=[...t]}buildFormFields(){if(0===this.formFields.length)this.buildDefaultFormFields();else{const t=[];this.formFields.forEach(e=>{const n=Object.assign({},e);"password"===n.type&&(n.hint=(0,o.i)(n)?(0,s.h)("div",null,r.o.get(i.T.FORGOT_PASSWORD_TEXT)," ",(0,s.h)("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.A.ForgotPassword),"data-test":"sign-in-forgot-password-link"},r.o.get(i.T.RESET_PASSWORD_TEXT))):n.hint),n.handleInputChange=a=>this.handleFormFieldInputWithCallback(a,e),this.setFieldValue(n,this.signInAttributes),t.push(n)}),this.newFormFields=t}}setFieldValue(t,e){switch(t.type){case"username":case"email":e.userInput=void 0===t.value?"":t.value;break;case"phone_number":t.dialCode&&(this.phoneNumber.countryDialCodeValue=t.dialCode),this.phoneNumber.phoneNumberValue=t.value;break;case"password":e.password=void 0===t.value?"":t.value}}render(){return(0,s.h)(s.H,null,(0,s.h)("amplify-form-section",{headerText:r.o.get(this.headerText),handleSubmit:this.handleSubmit,testDataPrefix:"sign-in"},(0,s.h)("div",{slot:"subtitle"},(0,s.h)("slot",{name:"header-subtitle"})),(0,s.h)("slot",{name:"federated-buttons"},(0,s.h)("amplify-federated-buttons",{handleAuthStateChange:this.handleAuthStateChange,federated:this.federated})),!(0,I.xb)(this.federated)&&(0,s.h)("amplify-strike",null,"or"),(0,s.h)("amplify-auth-fields",{formFields:this.newFormFields}),(0,s.h)("div",{slot:"amplify-form-section-footer",class:"sign-in-form-footer"},(0,s.h)("slot",{name:"footer"},!this.hideSignUp&&(0,s.h)("slot",{name:"secondary-footer-content"},(0,s.h)("span",null,r.o.get(i.T.NO_ACCOUNT_TEXT)," ",(0,s.h)("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.A.SignUp),"data-test":"sign-in-create-account-link"},r.o.get(i.T.CREATE_ACCOUNT_TEXT)))),(0,s.h)("div",{class:this.hideSignUp?"full-width-footer-content":""},(0,s.h)("slot",{name:"primary-footer-content"},(0,s.h)("amplify-button",{type:"submit",disabled:this.loading,"data-test":"sign-in-sign-in-button"},this.loading?(0,s.h)("amplify-loading-spinner",null):(0,s.h)("span",null,r.o.get(this.submitButtonText)))))))))}static get watchers(){return{formFields:["formFieldsHandler"]}}};y.style=":host{--footer-size:var(--amplify-text-sm);--footer-color:var(--amplify-grey);--footer-font-family:var(--amplify-font-family);--font-weight:var(--amplify-font-weight)}.sign-in-form-footer{font-family:var(--footer-font-family);font-size:var(--footer-size);color:var(--footer-color);font-weight:--font-weight;display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around}.sign-in-form-footer amplify-button{margin-bottom:0.625rem}@media (min-width: 672px){.sign-in-form-footer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:baseline;align-items:baseline}.sign-in-form-footer amplify-button{margin-bottom:0}}.sign-in-form-footer *+*{margin-bottom:15px}.full-width-footer-content{width:100%}";const A=class{constructor(t){(0,s.r)(this,t),this.handleSubmit=e=>this.signUp(e),this.handleSignUp=e=>this.authSignUp(e),this.headerText=i.T.SIGN_UP_HEADER_TEXT,this.submitButtonText=i.T.SIGN_UP_SUBMIT_BUTTON_TEXT,this.haveAccountText=i.T.SIGN_UP_HAVE_ACCOUNT_TEXT,this.signInText=i.T.SIGN_IN_TEXT,this.formFields=[],this.handleAuthStateChange=o.d,this.usernameAlias="username",this.newFormFields=[],this.phoneNumber={countryDialCodeValue:h.g,phoneNumberValue:null},this.loading=!1,this.signUpAttributes={username:"",password:"",attributes:{}}}handleFormFieldInputChange(t){switch(t){case"username":return e=>this.signUpAttributes.username=e.target.value;case"password":return e=>this.signUpAttributes.password=e.target.value;case"email":return e=>this.signUpAttributes.attributes.email=e.target.value;case"phone_number":return e=>(0,o.h)(e,this.phoneNumber);default:return e=>this.signUpAttributes.attributes[t]=e.target.value}}handleFormFieldInputWithCallback(t,e){(e.handleInputChange?e.handleInputChange:(d,g)=>{g(d)})(t,this.handleFormFieldInputChange(e.type).bind(this))}authSignUp(t){return(0,m.Z)(function*(){const e=yield u.g.signUp(t);if(!e)throw new Error(i.T.SIGN_UP_FAILED);return e})()}assignPhoneNumberToSignUpAttributes(){if(this.phoneNumber.phoneNumberValue)try{this.signUpAttributes.attributes.phone_number=(0,o.b)(this.phoneNumber)}catch(t){(0,o.a)(t)}}assignUserNameAliasToSignUpAttributes(){switch(this.usernameAlias){case"email":case"phone_number":this.signUpAttributes.username=this.signUpAttributes.attributes[this.usernameAlias]}}assignFormInputToSignUpAttributes(){this.assignPhoneNumberToSignUpAttributes(),this.assignUserNameAliasToSignUpAttributes()}validateSignUpAttributes(){if(!this.signUpAttributes.username)throw this.usernameAlias===l.U.email?new Error(i.T.EMPTY_EMAIL):this.usernameAlias===l.U.phone_number?new Error(i.T.EMPTY_PHONE):new Error(i.T.EMPTY_USERNAME);if(this.signUpAttributes.username.indexOf(" ")>=0)throw new Error(i.T.USERNAME_REMOVE_WHITESPACE);if(this.signUpAttributes.password!==this.signUpAttributes.password.trim())throw new Error(i.T.PASSWORD_REMOVE_WHITESPACE)}signUp(t){var e=this;return(0,m.Z)(function*(){if(t&&t.preventDefault(),!u.g||"function"!=typeof u.g.signUp)throw new Error(h.N);e.loading=!0,e.assignFormInputToSignUpAttributes();try{e.validateSignUpAttributes();const n=yield e.handleSignUp(e.signUpAttributes);if(n.userConfirmed)yield(0,f.h)(e.signUpAttributes.username,e.signUpAttributes.password,e.handleAuthStateChange);else{const a=Object.assign({},e.signUpAttributes);e.handleAuthStateChange(l.A.ConfirmSignUp,Object.assign(Object.assign({},n.user),{signUpAttrs:a}))}}catch(n){(0,o.a)(n)}finally{e.loading=!1}})()}buildDefaultFormFields(){switch(this.usernameAlias){case"email":this.newFormFields=[{type:"email",placeholder:r.o.get(i.T.SIGN_UP_EMAIL_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-up-email-input",autocomplete:"username"}},{type:"password",placeholder:r.o.get(i.T.SIGN_UP_PASSWORD_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-up-password-input",autocomplete:"new-password"}},{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-up-phone-number-input",autocomplete:"tel-national"}}];break;case"phone_number":this.newFormFields=[{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-up-phone-number-input",autocomplete:"username"}},{type:"password",placeholder:r.o.get(i.T.SIGN_UP_PASSWORD_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-up-password-input",autocomplete:"new-password"}},{type:"email",placeholder:r.o.get(i.T.SIGN_UP_EMAIL_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-up-email-input",autocomplete:"email"}}];break;case"username":default:this.newFormFields=[{type:"username",placeholder:r.o.get(i.T.SIGN_UP_USERNAME_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("username"),inputProps:{"data-test":"sign-up-username-input",autocomplete:"username"}},{type:"password",placeholder:r.o.get(i.T.SIGN_UP_PASSWORD_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-up-password-input",autocomplete:"new-password"}},{type:"email",placeholder:r.o.get(i.T.SIGN_UP_EMAIL_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-up-email-input"}},{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-up-phone-number-input"}}]}}buildFormFields(){if(0===this.formFields.length)this.buildDefaultFormFields();else{const t=[];this.formFields.forEach(e=>{const n=Object.assign({},e);n.handleInputChange=a=>this.handleFormFieldInputWithCallback(a,e),this.setFieldValue(e,this.signUpAttributes),t.push(n)}),this.newFormFields=t}}setFieldValue(t,e){switch(t.type){case"username":e.username=void 0===t.value?"":t.value;break;case"password":e.password=void 0===t.value?"":t.value;break;case"email":e.attributes.email=t.value;break;case"phone_number":t.dialCode&&(this.phoneNumber.countryDialCodeValue=t.dialCode),this.phoneNumber.phoneNumberValue=t.value;break;default:e.attributes[t.type]=t.value}}componentWillLoad(){(0,o.c)(this.usernameAlias),this.buildFormFields()}formFieldsHandler(){this.buildFormFields()}render(){return(0,s.h)(s.H,null,(0,s.h)("amplify-form-section",{headerText:r.o.get(this.headerText),handleSubmit:this.handleSubmit,testDataPrefix:"sign-up"},(0,s.h)("div",{slot:"subtitle"},(0,s.h)("slot",{name:"header-subtitle"})),(0,s.h)("amplify-auth-fields",{formFields:this.newFormFields}),(0,s.h)("div",{class:"sign-up-form-footer",slot:"amplify-form-section-footer"},(0,s.h)("slot",{name:"footer"},(0,s.h)("slot",{name:"secondary-footer-content"},(0,s.h)("span",null,r.o.get(this.haveAccountText)," ",(0,s.h)("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.A.SignIn),"data-test":"sign-up-sign-in-link"},r.o.get(this.signInText)))),(0,s.h)("slot",{name:"primary-footer-content"},(0,s.h)("amplify-button",{type:"submit","data-test":"sign-up-create-account-button",disabled:this.loading},this.loading?(0,s.h)("amplify-loading-spinner",null):(0,s.h)("span",null,r.o.get(this.submitButtonText))))))))}static get watchers(){return{formFields:["formFieldsHandler"]}}};A.style="amplify-sign-up{--footer-font-family:var(--amplify-font-family);--footer-font-size:var(--amplify-text-sm);--footer-color:var(--amplify-grey);--font-weight:var(--amplify-font-weight)}.sign-up-form-footer{font-family:var(--footer-font-family);font-size:var(--footer-font-size);color:var(--footer-color);font-weight:--font-weight;display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around}.sign-up-form-footer amplify-button{margin-bottom:0.625rem}@media (min-width: 672px){.sign-up-form-footer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:baseline;align-items:baseline}.sign-up-form-footer amplify-button{margin-bottom:0}}.sign-up-form-footer *+*{margin-bottom:15px}";const c=new b.k("AmplifyVerifyContact"),v=class{constructor(t){(0,s.r)(this,t),this.handleAuthStateChange=o.d,this.loading=!1}handleSubmit(t){t.preventDefault(),this.verifyAttr?this.submit(this.code):this.verify(this.contact)}submit(t){var e=this;return(0,m.Z)(function*(){const n=e.verifyAttr;if(!u.g||"function"!=typeof u.g.verifyCurrentUserAttributeSubmit)throw new Error(h.N);e.loading=!0;try{const a=yield u.g.verifyCurrentUserAttributeSubmit(n,t);c.debug(a),e.handleAuthStateChange(l.A.SignedIn,e.user),e.verifyAttr=null}catch(a){(0,o.a)(a),c.error(a)}finally{e.loading=!1}})()}verify(t){var e=this;return(0,m.Z)(function*(){if(t){if(!u.g||"function"!=typeof u.g.verifyCurrentUserAttribute)throw new Error(h.N);e.loading=!0;try{const n=yield u.g.verifyCurrentUserAttribute(t);c.debug(n),e.verifyAttr=t}catch(n){(0,o.a)(n),c.error(n)}finally{e.loading=!1}}else c.error("Neither Email nor Phone Number selected")})()}handleInputChange(t){const e=t.target.name;"code"===e?this.code=t.target.value:"contact"===e&&(this.contact=t.target.value)}renderSubmit(){return(0,s.h)("div",null,(0,s.h)("amplify-input",{inputProps:{autocomplete:"off","data-test":"verify-contact-code-input"},name:"code",placeholder:r.o.get(i.T.CODE_PLACEHOLDER),handleInputChange:t=>this.handleInputChange(t)}))}renderVerify(){const t=this.user;if(!t)return c.debug("No user to verify"),null;const{unverified:e}=t;if(!e)return c.debug("Unverified variable does not exist on user"),null;const{email:n,phone_number:a}=e;return(0,s.h)("div",null,n&&(0,s.h)("amplify-radio-button",{label:r.o.get(i.T.VERIFY_CONTACT_EMAIL_LABEL),key:"email",name:"contact",value:"email",handleInputChange:d=>this.handleInputChange(d),inputProps:{"data-test":"verify-contact-email-radio"}}),a&&(0,s.h)("amplify-radio-button",{label:r.o.get(i.T.VERIFY_CONTACT_PHONE_LABEL),key:"phone_number",name:"contact",value:"phone_number",handleInputChange:d=>this.handleInputChange(d),inputProps:{"data-test":"verify-contact-phone-number-radio"}}))}render(){return(0,s.h)(s.H,null,(0,s.h)("amplify-form-section",{handleSubmit:t=>this.handleSubmit(t),headerText:r.o.get(i.T.VERIFY_CONTACT_HEADER_TEXT),loading:this.loading,secondaryFooterContent:(0,s.h)("span",null,(0,s.h)("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.A.SignedIn,this.user),"data-test":"verify-contact-skip-link"},"Skip")),submitButtonText:r.o.get(this.verifyAttr?i.T.VERIFY_CONTACT_SUBMIT_LABEL:i.T.VERIFY_CONTACT_VERIFY_LABEL)},this.verifyAttr?this.renderSubmit():this.renderVerify()))}}}}]);